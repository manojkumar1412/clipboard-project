# Ticket Breakdown
We are a staffing company whose primary purpose is to book Agents at Shifts posted by Facilities on our platform. We're working on a new feature which will generate reports for our client Facilities containing info on how many hours each Agent worked in a given quarter by summing up every Shift they worked. Currently, this is how the process works:

- Data is saved in the database in the Facilities, Agents, and Shifts tables
- A function `getShiftsByFacility` is called with the Facility's id, returning all Shifts worked that quarter, including some metadata about the Agent assigned to each
- A function `generateReport` is then called with the list of Shifts. It converts them into a PDF which can be submitted by the Facility for compliance.

## You've been asked to work on a ticket. It reads:

**Currently, the id of each Agent on the reports we generate is their internal database id. We'd like to add the ability for Facilities to save their own custom ids for each Agent they work with and use that id when generating reports for them.**


Based on the information given, break this ticket down into 2-5 individual tickets to perform. Provide as much detail for each ticket as you can, including acceptance criteria, time/effort estimates, and implementation details. Feel free to make informed guesses about any unknown details - you can't guess "wrong".


You will be graded on the level of detail in each ticket, the clarity of the execution plan within and between tickets, and the intelligibility of your language. You don't need to be a native English speaker, but please proof-read your work.

## Your Breakdown Here
### Assumptions:
* We have DDL(Database Script) scipts written in a DB file.
* getShiftsByFacility function is used to fetch the data from Database and hence, a connection to DB is present in this function.
* getShiftsByFacility function uses joins to fetch the information.
* generateReport function doesn't have database access and this is just a function to display the passed data to it.
* CRUD for Agent model exists and is exposed to the client.

### Ticket breakdown: 
* Add a column in Agent table to add a field named agent_user_id, make the necessary changes in Database script to add this field. Also add an index to this field as there is a possibility that we might need to query on specific agent_user_id.
    * Acceptance Criteria:
        * AC1: A DB command to add a non null, unique column is added to Database scripts.
        * AC2: Initially Make the default value of the field same as DB id as we don't have userId currently.
        * AC3: Create an index on the field as well.
    * Time/Effort: 1 SP(1 man day of effort, small change, Doable in an hour, however, depending upon pipeline and all might take some more time, 1 Man day effort looks sufficient for even new comer with basic DB knowledge)

* Add a mandatory field with agentUserId in Create and Update form of Agent Model. Verify that new Agent is created with agentUserId and existing Agent can be updated with agentUserId. [The reason I have created one ticket for Create and Update is that, most of the time in new framework we have same form for create and update]
    * Acceptance Criteria:
        * AC1: Create Agent form should ask for a mandatory field 'Agent User Id'
        * AC2: Upon clicking on Create/Save button, Agent must be created with provided Agent User Id
        * AC3: Agent creation should fail for duplicate agent user id
        * AC4: Agent creation should fail for blank value
        * AC5: Update Agent form should follow the above acceptance criteria
    * Time/Effort: 3 SP(3 man day of effort)
    * Implementation Details: 
        * Changes needed in the UI form to have a new field. 
        * Changes needed in the Agent DB model.
        * Changes needed in Agent Controller for storing the new field(most of the framework doesn't need any change for this). 
        * UT and IT should be added for the above scenarios.

* Make changes in getShiftsByFacility function to fetch agentUserId as well.
    * Acceptance Criteria:
        * AC1: List of shift returned by the function should have agentUserId field as well.
    * Time/Effort: 3 SP(3 man day of effort)
    * Implementation Details: 
        * Changes needed in the function to fetch agentUserId (need to modify joins sql statement/ fetch agent userId later and map to each shift)
        * Changes needed in response object of the function.
        * UT and IT should be added for the above scenarios.

* Make changes in generateReport function to use agentUserId in PDF.
    * Acceptance Criteria:
        * AC1: PDF generated by the function should have agentUserId field instead of DB id of agent.
    * Time/Effort: 2 SP(2 man day of effort)
    * Implementation Details: 
        * Changes needed in the function to display agentUserId instead of agentDbId
        * UT and IT should be added for the above scenarios.(I assume we have some utility to integrate with PDF.)
